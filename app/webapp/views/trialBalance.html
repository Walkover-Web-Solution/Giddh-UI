<!-- structure -->

<div class="container-fluid">
  <div class="row">
    <!-- left side -->
    <div class="col-md-2 col-sm-2 greyBg">
      <div>
        <div ng-controller="accountController" id="left" auto-height>
          <div ng-include="'/public/webapp/views/accounts.html'"></div>
          <ui-view
          ="ledger.accounts"></ui-view>
        </div>
      </div>
    </div>
    <!-- middle body -->
    <div class="col-md-10 col-sm-7">
      <div class="loader mrT4" ng-hide="showLedgerBox">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div class="middleBody bdrR bdrL row"  ng-show="showLedgerBox">
        <perfect-scrollbar class="scrClass" wheel-propagation="true" wheel-speed="1" min-scrollbar-length="20"
                           auto-height>
          <ul class="list-inline color-codes">
            <li><span class="circle assets"></span> Assets</li>
            <li><span class="circle liabilities"></span>Liabilities</span></li>
            <li><span class="circle income"></span>Income</li>
            <li><span class="circle expenses"></span>Expenses</li>
          </ul>
          <div class="form-inline pdB1 mrT2 mrL3 clearfix">
            <form class=" pull-left" name="fromToDateForm" novalidate>
              <div class="form-group mrR1">
                <label>From date</label>

                <p class="input-group max150">
                  <input type="text" class="form-control"
                         uib-datepicker-popup="{{format}}" required
                         datepicker-options="dateOptions"
                         is-open="fromDatePickerIsOpen"
                         ng-click="fromDatePickerOpen()"
                         ng-model="fromDate.date"
                         max-date="toDate.date"
                         placeholder="from date"
                      />
                     <span class="input-group-btn">
                     <button type="button" class="btn btn-default" ng-click="fromDatePickerOpen()"><i
                         class="glyphicon glyphicon-calendar"></i></button>
                     </span>
                </p>
              </div>
              <div class="form-group">
                <label>To date</label>

                <p class="input-group max150">
                  <input type="text" class="form-control"
                         uib-datepicker-popup="{{format}}" required
                         datepicker-options="dateOptions"
                         is-open="toDatePickerIsOpen"
                         ng-click="toDatePickerOpen()"
                         ng-model="toDate.date" min-date="fromDate.date" max-date="today" placeholder="to date"
                      />
                      <span class="input-group-btn">
                      <button type="button" class="btn btn-default" ng-click="toDatePickerOpen()"><i
                          class="glyphicon glyphicon-calendar"></i></button>
                      </span>
                </p>
              </div>
              <div class="form-group">
                <button type="button" class="btn btn-success mrL1" ng-click="filterBydate()">
                  Apply
                </button>
              </div>
            </form>
            <div class="input-group input-group-md pull-right mrR3">
              <span class="input-group-addon" id="sizing-addon3"><i class="glyphicon glyphicon-search"></i></span>
              <input type="search" class="form-control" placeholder="Search" aria-describedby="sizing-addon3"
                     ng-model="keyWord" ng-keydown="expandAccordionOnSearch($event)" str-length clear-tbsearch>
              <i class="glyphicon glyphicon-remove close-icon" ng-show="showClearSearch"></i>
            </div>

            <div class="pull-right export">  
              <a href="" title="" download="" ng-click="formatData($event)"><img src="/public/webapp/images/csv.png" class="csv"/></a>
              <div class="export-options" ng-show="showOptions">
                <span class="arrow"></span>
                <ul class="list-unstyled">
                  <li><a href="" ng-click="hideOptions($event)" export-report data-report="group-wise">Group Wise
                    Report</a></li>
                  <li><a href="" ng-click="hideOptions($event)" export-report data-report="condensed">Condensed
                    Report</a></li>
                  <li><a href="" ng-click="hideOptions($event)" export-report data-report="account-wise">Account Wise
                    Report</a></li>
                </ul>
              </div>
            </div>

            <div class="pull-right pdf-export">
              <a href="" ng-click="showPdfOptions($event)"><img src="/public/webapp/images/pdf-icon.png" /></a>
              <div class="export-options" ng-show="showpdf">
                <span class="arrow"></span>
                <ul class="list-unstyled">
                  <li><a href="" ng-click="hideOptions($event)" export-pdfgroupwise>Group Wise
                    Report</a></li>
                  <li><a href="" ng-click="hideOptions($event)" export-pdfcondensed>Condensed
                    Report</a></li>
                  <li><a href="" ng-click="hideOptions($event)" export-pdfaccountwise>Account Wise
                    Report</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="row toggle-btns">
            <button class="btn btn-primary pull-left mrL1" ng-class="{'fadeIn':showChildren}" accordion-controls data-action="expandAll">Expand All</button>
            <button class="btn btn-danger pull-left mrL1" ng-class="{'fadeIn':showChildren}" accordion-controls data-action="closeAll">Collapse All</button>
          </div>
          <div class="table-container">
            <table class="col-sm-12 tb-head" ng-show="showLedgerBox">
              <thead>
              <tr>
                <th class="col-sm-4">Particular</th>
                <th class="col-sm-2">Opening Bal</th>
                <th class="col-sm-4 text-center">
                  Transactions
                  <table class="col-sm-12">
                    <thead>
                    <tr>
                      <th class="col-sm-6 text-left">Debit(Dr.)</th>
                      <th class="col-sm-6 text-left">Credit(Cr.)</th>
                    </tr>
                    </thead>
                  </table>
                </th>
                <th class="col-sm-2">Closing Bal</th>
              </tr>
              </thead>
            </table>
            <v-accordion class="vAccordion--default root"
                         control="accordion" multiple onexpand="addData()">
              <v-pane ng-repeat="grp in data.groupDetails | filter:keyWord" expanded="expanded" ng-class="grp.category" >
                <v-pane-header ng-class="{'show-pseudo' : !grp.childGroups.length && !grp.accounts.length, 'no-child' : !grp.childGroups.length && !grp.accounts.length, 'no-data': grp.closingBalance.amount == 0}" >
                  <table class="col-sm-12 fl-none">
                    <tbody>
                    <tr>
                      <td class="col-sm-4"><b ng-bind-html=" grp.groupName | uppercase | highlight: keyWord"></b></td>
                      <td class="col-sm-2 text-right">{{ grp.forwardedBalance.amount | number:2 }} {{
                        grp.forwardedBalance.type | recType:grp.forwardedBalance.amount }}
                      </td>
                      <td class="col-sm-4  text-right">
                        <table class="col-sm-12 fl-none">
                          <tbody>
                          <tr>
                            <td class="col-sm-6 text-right">{{ grp.debitTotal | number:2 }}</td>
                            <td class="col-sm-6 text-right">{{ grp.creditTotal | number:2 }}</td>
                          </tr>
                          </tbody>
                        </table>
                      </td>
                      <td class="col-sm-2 text-right">{{ grp.closingBalance.amount | number:2 }}
                        {{grp.closingBalance.type | recType:grp.closingBalance.amount}}
                      </td>
                    </tr>
                    </tbody>
                  </table>
                </v-pane-header>
                <v-pane-content>
                  <!--account-->
                  <v-accordion ng-if="grp.accounts.length" multiple>
                    <v-pane ng-repeat="account in grp.accounts  | filter:keyWord" expanded="expanded">
                      <v-pane-header>
                        <table class="col-sm-12 fl-none">
                          <tbody>
                          <tr>
                            <td class="col-sm-4" ng-bind-html=" account.name | uppercase | highlight: keyWord"></td>
                            <td class="col-sm-2  text-right">{{ account.openingBalance.amount | number:2 }}
                              {{account.openingBalance.type | recType:account.openingBalance.amount}}
                            </td>
                            <td class="col-sm-4">
                              <table class="col-sm-12 fl-none">
                                <tbody>
                                <tr>
                                  <td class="col-sm-6 text-right">{{ account.debitTotal | number:2 }}</td>
                                  <td class="col-sm-6 text-right">{{ account.creditTotal | number:2 }}</td>
                                </tr>
                                </tbody>
                              </table>
                            </td>
                            <td class="col-sm-2  text-right">{{ account.closingBalance.amount | number:2 }}
                              {{account.closingBalance.type | recType:account.closingBalance.amount}}
                            </td>
                          </tr>
                          </tbody>
                        </table>
                      </v-pane-header>
                      <v-pane-content>
                      </v-pane-content>
                    </v-pane>
                  </v-accordion>
                  <!--subgroup-->
                  <v-accordion ng-if="grp.childGroups.length && showChildren" multiple>
                    <div ng-include="'trialBalSubGroup'"></div>
                  </v-accordion>
                </v-pane-content>
              </v-pane>
            </v-accordion>
            <table class="col-sm-12 tb-foot" ng-show="showLedgerBox">
              <thead>
              <tr>
                <th class="col-sm-4">Grand Total</th>
                <th class="col-sm-2  text-right">{{ data.forwardedBalance.amount | number:2 }}</th>
                <th class="col-sm-4">
                  <table class="col-sm-12">
                    <thead>
                    <tr>
                      <th class="col-sm-6 text-right">{{ data.debitTotal | number:2 }}</th>
                      <th class="col-sm-6 text-right">{{ data.creditTotal | number:2 }}</th>
                    </tr>
                    </thead>
                  </table>
                </th>
                <th class="col-sm-2  text-right">{{ data.closingBalance.amount | number:2 }}</th>
              </tr>
              </thead>
            </table>
          </div>
        </perfect-scrollbar>
      </div>
    </div>
  </div>
  <!-- end of row -->
</div>

<script type="text/ng-template" id="trialBalSubGroup">
  <v-pane ng-repeat="grp in grp.childGroups  | filter:keyWord" expanded="expanded">
    <v-pane-header ng-class="{'noChild' : !grp.childGroups.length && !grp.accounts.length}" ng-click="showNLevelList($event)">
      <table class="col-sm-12 fl-none">
        <tbody>
        <tr>
          <td class="col-sm-4" ng-bind-html="grp.groupName | uppercase : (grp.childGroups.length && grp.accounts.length) | highlight: keyWord"></td>
          <td class="col-sm-2  text-right">{{ grp.forwardedBalance.amount | number:2 }} {{ grp.forwardedBalance.type |
            recType: grp.forwardedBalance.amount}}
          </td>
          <td class="col-sm-4  text-right">
            <table class="col-sm-12 fl-none">
              <tbody>
              <tr>
                <td class="col-sm-6 text-right">{{ grp.debitTotal | number:2 }}</td>
                <td class="col-sm-6 text-right">{{ grp.creditTotal | number:2 }}</td>
              </tr>
              </tbody>
            </table>
          </td>
          <td class="col-sm-2  text-right">{{ grp.closingBalance.amount | number:2 }} {{ grp.closingBalance.type |
            recType: grp.closingBalance.amount }}
          </td>
        </tr>
        </tbody>
      </table>
    </v-pane-header>
    <v-pane-content>

      <!--subgroup/account-->
      <v-accordion ng-if="grp.accounts.length && showNLevel"  multiple>
        <v-pane ng-repeat="account in grp.accounts" disabled expanded="expanded" >
          <v-pane-header>
            <table class="col-sm-12 fl-none">
              <tbody>
              <tr>
                <td class="col-sm-4" ng-bind-html=" account.name | lowercase | highlight: keyWord"></td>
                <td class="col-sm-2  text-right">{{ account.openingBalance.amount | number:2 }} {{
                  account.openingBalance.type | recType:account.openingBalance.amount }}
                </td>
                <td class="col-sm-4">
                  <table class="col-sm-12 fl-none">
                    <tbody>
                    <tr>
                      <td class="col-sm-6 text-right">{{ account.debitTotal | number:2 }}</td>
                      <td class="col-sm-6 text-right">{{ account.creditTotal | number:2 }}</td>
                    </tr>
                    </tbody>
                  </table>
                </td>
                <td class="col-sm-2 text-right">{{ account.closingBalance.amount | number:2 }} {{
                  account.closingBalance.type | recType:account.closingBalance.amount }}
                </td>
              </tr>
              </tbody>
            </table>
          </v-pane-header>
          <v-pane-content>
          </v-pane-content>
        </v-pane>
      </v-accordion>

      <!--subgroup/group-->
      <v-accordion ng-if="grp.childGroups.length" multiple>
        <div ng-include="'trialBalSubGroup'"></div>
      </v-accordion>
    </v-pane-content>
  </v-pane>
</script>
