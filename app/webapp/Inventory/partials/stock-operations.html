<section class="col-xs-12">
	<div class="pd2">
		<div class="row form_title">
			<label ng-if="!vm.addStockObj.uniqueName">Add Stock</label>
			<label ng-if="vm.addStockObj.uniqueName">Modify Stock</label>
		</div>
	
		<div class="row">
			<form name="addEditStockForm" class="form-theme clearfix" novalidate>
				
				<div class="row mr0">
					<div class="form-group col-xs-6 pdL0 pdR">
						<label>Name<span class="required">*</span></label>
						<input type="text" name="name" class="form-control" ng-model="vm.addStockObj.name" required minlength="2">
					</div>
					<!-- show only when update -->
					<div ng-if="vm.addStockObj.uniqueName" class="form-group col-xs-6 pdR0 pdL">
						<label>Unique Name<span class="required">*</span></label>
						<input type="text" name="uniqueName" class="form-control" ng-model="vm.addStockObj.uniqueName" required>
					</div>			
				</div>

				<div class="row mr0">
					<div class="form-group col-xs-3 pdL0 pdR">
						<label>Stock Unit<span class="required">*</span></label>
						<ui-select ng-model="vm.addStockObj.stockUnitCode" theme="bootstrap" required>
              <ui-select-match>
                <span>{{$select.selected.code}}</span>
              </ui-select-match>
              <ui-select-choices repeat="unit.code as unit in vm.customUnits track by $index">
              	<span ng-bind="unit.name"></span>&nbsp;
              	(<span ng-bind="unit.code"></span>)
              </ui-select-choices>
            </ui-select>
					</div>

					<div class="form-group col-xs-3 pdR">
						<label>Open. Qty</label>
						<input type="number" name="openingQuantity" class="form-control" ng-model="vm.addStockObj.openingQuantity">
					</div>

					<div class="form-group col-xs-3 pdL">
						<label>Amount</label>
						<input type="number" name="openingAmount" class="form-control" ng-model="vm.addStockObj.openingAmount">
					</div>

					<!--amount/quantity formula manuallly calculate -->
					<div class="form-group col-xs-3 pdL pdR0 ">
						<label>Rate per stock unit</label>
						<input readonly="true" type="text" class="form-control" placeholder="calculate later" value="{{vm.addStockObj.openingAmount/vm.addStockObj.openingQuantity | number}}" />
					</div>

				</div>

				<div class="row mr0 col-xs-6 pdL0 pdR">
					<div class="form-group col-xs-12 pdL0 pdR">
						<label>Purchase Acc</label>
	        	<ui-select ng-model="vm.addStockObj.purchaseAccountDetails.accountUniqueName" theme="bootstrap">
              <ui-select-match allow-clear="true" placeholder="select purchase account">
                <span>{{$select.selected.name}}</span>
              </ui-select-match>
              <ui-select-choices repeat="account.uniqueName as account in vm.purchaseAccounts | filter:$select.search | limitTo:5" refresh="vm.getPurchaseAccounts($select.search)">
              	<span ng-bind="account.name"></span>
              </ui-select-choices>
            </ui-select>
					</div>

					<div class="col-xs-6 pdR0 pdL0 mrB">
						<label>Unit<span class="required">*</span></label>
					</div>
					<div class="col-xs-5 pdR1 mrB">
						<label>Rate</label>
					</div>

					<div class="mutliple_unit" ng-repeat="item in vm.addStockObj.purchaseAccountDetails.unitRates track by $index">
						<div class="col-xs-6 pdR0 pdL0 mrB">
							<ui-select ng-model="item.stockUnitCode" theme="bootstrap">
		            <ui-select-match>
	                <span>{{$select.selected.code}}</span>
	              </ui-select-match>
	              <ui-select-choices repeat="unit.code as unit in vm.customUnits track by $index">
	              	<span ng-bind="unit.name"></span>&nbsp;
	              	(<span ng-bind="unit.code"></span>)
	              </ui-select-choices>
		          </ui-select>
						</div>
						<div class="col-xs-5 pdR1 mrB">
							<input type="number" class="form-control" ng-model="item.rate" />
							
							<!-- action -->
							<span>
								<button ng-if="$last" ng-click="vm.addUnitItem(item, 'pArr')"><i class="fa fa-plus add_row"></i></button
								>
								<button ng-hide="$last" ng-click="vm.removeUnitItem(item, 'pArr')"><i class="fa fa-times dlet"></i></button>
							</span>
						</div>
					</div>

				</div>


				<div class="row mr0 col-xs-6 pdL pdR0">
					<div class="form-group col-xs-12 pdL0 pdR">
						<label>Sales Acc</label>
						<ui-select ng-model="vm.addStockObj.salesAccountDetails.accountUniqueName" theme="bootstrap">
              <ui-select-match  allow-clear="true" placeholder="select sales account">
              	<span>{{$select.selected.name}}</span>
              </ui-select-match>
              <ui-select-choices repeat="account.uniqueName as account in vm.salesAccounts | filter:$select.search | limitTo:5" refresh="vm.getSalesAccounts($select.search)">
                <span ng-bind="account.name"></span>
              </ui-select-choices>
            </ui-select>
					</div>

				

					<div class="col-xs-6 pdR0 pdL0 mrB">
						<label>Unit<span class="required">*</span></label>
					</div>
					<div class="col-xs-5 pdR1 mrB">
						<label>Rate</label>
					</div>

					<div class="mutliple_unit" ng-repeat="item in vm.addStockObj.salesAccountDetails.unitRates track by $index">
						<div class="col-xs-6 pdR0 pdL0 mrB">
							<ui-select ng-model="item.stockUnitCode" theme="bootstrap">
		            <ui-select-match>
	                <span>{{$select.selected.code}}</span>
	              </ui-select-match>
	              <ui-select-choices repeat="unit.code as unit in vm.customUnits track by $index">
	              	<span ng-bind="unit.name"></span>&nbsp;
	              	(<span ng-bind="unit.code"></span>)
	              </ui-select-choices>
		          </ui-select>
						</div>
						<div class="col-xs-5 pdR1 mrB">
							<input type="number" class="form-control" ng-model="item.rate" />
							
							<!-- action -->
							<span>
								<button ng-if="$last" ng-click="vm.addUnitItem(item, 'sArr')"><i class="fa fa-plus add_row"></i></button
								>
								<button ng-hide="$last" ng-click="vm.removeUnitItem(item, 'sArr')"><i class="fa fa-times dlet"></i></button>
							</span>
						</div>
					</div>
					
				</div>

				<div class="row mrT1">
					<div class="col-xs-12">
					<!-- vm.addStockObj. -->
						<div class="checkbox">
							<label for="isFsStock" ng-click="$event.stopPropagation()">
								<input type="checkbox" ng-model="vm.addStockObj.isFsStock" id="isFsStock" name="isFsStock" />Is it a finished stock? (Manufacturing/Combo)</label>
						</div>
					</div>
				</div>

				<!-- combo code -->
				<div class="row mrT1" ng-if="vm.addStockObj.isFsStock">
					<div class="form_title mrB2">
						<label>{{vm.addStockObj.name}} (Made with)</label>
					</div>

					<div class="col-xs-7">
						<div class="clearfix">
							<div class="form-group col-xs-3 pdL0 pdR mrB">
								<label>Select Stock<span class="required">*</span></label>
								<ui-select ng-model="vm.mfsCmbItem.stockUniqueName" theme="bootstrap">
			            <ui-select-match>
		                <span>{{$select.selected.uniqueName}}</span>
		              </ui-select-match>
		              <ui-select-choices repeat="unit.uniqueName as unit in stock.allStocks track by $index">
		              	<span ng-bind="unit.name"></span>&nbsp;
		              	(<span ng-bind="unit.uniqueName"></span>)
		              </ui-select-choices>
			          </ui-select>
							</div>

							<div class="form-group col-xs-3 pdR0 pdL mrB">
								<label>Stock Unit<span class="required">*</span></label>
								<ui-select ng-model="vm.mfsCmbItem.stockUnitCode" theme="bootstrap">
			            <ui-select-match>
		                <span>{{$select.selected.code}}</span>
		              </ui-select-match>
		              <ui-select-choices repeat="unit.code as unit in vm.customUnits track by $index">
		              	<span ng-bind="unit.name"></span>&nbsp;
		              	(<span ng-bind="unit.code"></span>)
		              </ui-select-choices>
			          </ui-select>
							</div>

							<div class="form-group col-xs-3 pdR0 pdL mrB">
								<label>Quantity per Unit<span class="required">*</span></label>
								<input type="text" name="quantity" class="form-control" ng-model="vm.mfsCmbItem.quantity" required>
							</div>
							<div class="form-group col-xs-3 pdR0 pdL mrB">
								<label class="col-xs-12">&nbsp;</label>
								<a ng-if="!vm.mfsCmbItem.hasIdx" class="btn btn-sm btn-primary" ng-click="vm.addMfsCmbItem()">Add</a>
								<a ng-if="vm.mfsCmbItem.hasIdx" class="btn btn-sm btn-primary" ng-click="vm.updateMfsCmbItem()">Update</a>
							</div>
						</div>

						<div class="row mrT1 mrB1" ng-if="vm.mfsCmbItemErrMsg">
							<div class="col-xs-12">
								<p class="text-warning">{{vm.mfsCmbItemErrMsg}}</p>
							</div>
						</div>

						<section class="linkstock" style="height: 200px;overflow-y: scroll;">
							<table class="col-xs-12 table_theme mrT">
								<tbody>
									<tr ng-repeat="list in vm.addStockObj.manufacturingDetails.linkedStocks track by $index">
										<td>{{list.stockUniqueName}}</td>
										<td>{{list.stockUnitCode}}</td>
										<td>{{list.quantity}}</td>
										<td class="action">
											<a href class="edit_btn" ng-click="vm.editMfsCmbItem(list, $index)">
												<i class="fa fa-pencil" aria-hidden="true"></i>Edit
											</a>
											<a href class="" ng-click="vm.deleteMfsCmbItem(list)">
												<i class="fa fa-trash-o" aria-hidden="true"></i> Delete
											</a>
										</td>
									</tr>
								</tbody>

							</table>
						</section>
					</div>
					<!-- end of col-xs-8 -->
					<div class="col-xs-3 pull-right">
						<h1 class="mrB2">Stock Name</h1>
						<section class="clearfix">
							<div class="form-group col-md-6 col-lg-6 col-xs-12">
								<span class="total-ico">=</span>
								<label>Quantity</label>
								<input type="text" class="form-control" ng-model="vm.addStockObj.manufacturingDetails.manufacturingQuantity" name="manufacturingQuantity" placeholder="Quantity" />
							</div>
							<div class="form-group col-md-6 col-lg-6 col-xs-12">
								<label>Select Unit</label>
								<ui-select ng-model="vm.addStockObj.manufacturingDetails.maufacturingUnitCode" theme="bootstrap">
			            <ui-select-match>
		                <span>{{$select.selected.code}}</span>
		              </ui-select-match>
		              <ui-select-choices repeat="unit.code as unit in vm.customUnits track by $index">
		              	<span ng-bind="unit.name"></span>&nbsp;
		              	(<span ng-bind="unit.code"></span>)
		              </ui-select-choices>
			          </ui-select>
							</div>
						</section>
					</div>
					<!-- end of col-xs-4 -->
				</div>
				<!-- combo code end-->
			
			
				<div class="row col-xs-12 mrT2">
					
					<button ng-if="!vm.addStockObj.uniqueName" type="submit" class="btn btn-sm btn-success mrR1" ng-disabled="addEditStockForm.$invalid"  ng-click="vm.addStock()">Save</button>

					<button ng-if="vm.addStockObj.uniqueName" type="submit" class="btn btn-sm btn-success mrR1" ng-disabled="addEditStockForm.$invalid"  ng-click="vm.updateStock()">Update</button>

					<button ng-click="vm.clearAddEditStockForm()" type="reset" class="btn btn-sm btn-primary">
						Cancel
					</button>
					
				</div>

			</form>
		</div>
	</div>
</section>